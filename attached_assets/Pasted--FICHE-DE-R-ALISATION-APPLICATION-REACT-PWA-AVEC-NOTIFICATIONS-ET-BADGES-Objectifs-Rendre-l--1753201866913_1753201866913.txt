âœ… FICHE DE RÃ‰ALISATION : APPLICATION REACT PWA AVEC NOTIFICATIONS ET BADGES
ðŸ“Œ Objectifs
Rendre lâ€™application installable sur mobile et PC (PWA)

Afficher lâ€™interface mÃªme hors ligne

AccÃ©der aux derniÃ¨res donnÃ©es sans connexion

Recevoir des notifications push

Afficher le nombre de messages non lus dans lâ€™interface

Afficher un badge sur lâ€™icÃ´ne de lâ€™application

ðŸ”§ 1. Ce qu'il faut avoir absolument dans le projet
mon-app/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ manifest.json
â”‚   â”œâ”€â”€ icons/
â”‚   â”‚   â”œâ”€â”€ icon-192x192.png
â”‚   â”‚   â””â”€â”€ icon-512x512.png
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ serviceWorkerRegistration.js
â”‚   â”œâ”€â”€ App.js
â”‚   â”œâ”€â”€ NotificationBadge.js
â”‚   â””â”€â”€ index.js
â”œâ”€â”€ package.json
â””â”€â”€ ...
âœ… 2. Activer le mode PWA dans React
a. Dans index.js :
import * as serviceWorkerRegistration from './serviceWorkerRegistration';
// ...
serviceWorkerRegistration.register();
b. CrÃ©e serviceWorkerRegistration.js (code fourni prÃ©cÃ©demment)
ðŸ‘‰ GÃ¨re l'enregistrement du service worker.

âœ… 3. Configurer le manifest.json
Dans public/manifest.json :

json
Copier
Modifier
{
  "short_name": "MonApp",
  "name": "Mon Application PWA",
  "icons": [
    {
      "src": "icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ],
  "start_url": ".",
  "display": "standalone",
  "theme_color": "#000000",
  "background_color": "#ffffff"
}
âœ… 4. Service Worker : notifications + donnÃ©es offline
a. Ajoute un fichier public/firebase-messaging-sw.js (si tu utilises Firebase Messaging)
ou utilise le service worker gÃ©nÃ©rÃ© par create-react-app pour les notifs avec :

self.addEventListener('push', function(event) {
  const data = event.data.json();
  self.registration.showNotification(data.title, {
    body: data.body,
    icon: '/icons/icon-192x192.png',
    badge: '/icons/icon-192x192.png',
  });
});
âœ… 5. Stockage des notifications (offline)
Exemple avec localStorage :
js
Copier
Modifier
useEffect(() => {
  const unread = localStorage.getItem('unreadCount');
  if (unread) setUnreadCount(parseInt(unread));
}, []);

useEffect(() => {
  localStorage.setItem('unreadCount', unreadCount);
}, [unreadCount]);
âœ… 6. Composant React pour le badge
NotificationBadge.js :

import React, { useEffect } from 'react';

const NotificationBadge = ({ unreadCount }) => {
  useEffect(() => {
    if ('setAppBadge' in navigator && unreadCount > 0) {
      navigator.setAppBadge(unreadCount);
    } else if ('clearAppBadge' in navigator && unreadCount === 0) {
      navigator.clearAppBadge();
    }
  }, [unreadCount]);

  return (
    <button className="notif-btn">
      ðŸ”” Notifications
      {unreadCount > 0 && (
        <span className="badge">{unreadCount}</span>
      )}
    </button>
  );
};

export default NotificationBadge;
Ajoute ce style dans ton CSS :

.badge {
  background-color: red;
  border-radius: 50%;
  color: white;
  padding: 4px 8px;
  font-size: 0.75rem;
  margin-left: 8px;
}
âœ… 7. DÃ©ploiement
Utilise un hÃ©bergeur HTTPS :

HÃ©bergeur	Commande / mÃ©thode
Firebase	firebase deploy
Netlify	drag & drop dossier build
Vercel	vercel

Commandes :

npm run build
npx serve -s build
ðŸ“± RÃ©sultat attendu
Fonction	RÃ©sultat
App installable sur mobile	âœ… Oui
Affichage offline	âœ… Oui
Notifications push	âœ… Oui
Badge dans interface	âœ… Oui
Badge sur icÃ´ne Android	âœ… Oui
Badge sur icÃ´ne iOS	âŒ Non (non supportÃ©)

ðŸ’¡ Recommandations supplÃ©mentaires
Utilise Workbox si tu veux un contrÃ´le avancÃ© du cache (stratÃ©gies, prioritÃ©s).

Utilise IndexedDB si tu veux stocker des objets complexes (ex: liste de messages).

Active le bouton "Ajouter Ã  l'Ã©cran d'accueil" avec beforeinstallprompt.

ðŸŽ Bonus â€“ DÃ©tection "hors-ligne"

useEffect(() => {
  const updateOnlineStatus = () => {
    setIsOnline(navigator.onLine);
  };
  window.addEventListener('online', updateOnlineStatus);
  window.addEventListener('offline', updateOnlineStatus);
  return () => {
    window.removeEventListener('online', updateOnlineStatus);
    window.removeEventListener('offline', updateOnlineStatus);
  };
}, []);